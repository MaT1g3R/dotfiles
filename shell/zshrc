export ZPLUG_HOME="$HOME/.zplug"
source $ZPLUG_HOME/init.zsh

setopt correct
export PATH=$HOME/bin:/usr/local/bin:$HOME/.local/bin:$PATH

for x in $HOME/dotfiles/shell/*.zsh; do source $x; done

export EDITOR=nvim
export VISUAL=nvim

#GPG stuff
export GPG_TTY=$(tty)
export GPG_AGENT_INFO=""
eval $(keychain --eval -Q --quiet id_dsa id_rsa)

# startup
if [ -z "$TMUX" ]; then 
    if [ `basename '/'$(ps -f -p $(cat /proc/$(echo $$)/stat | cut -d \  -f 4) | tail -1 | sed 's/^.* //')` != "yakuake" ]; then
        curl -s wttr.in/Toronto | head -n 17;
    fi
    task;
fi

# OS dependent config
if [ `uname` != 'Linux' ]; then # Linux
    export PATH="/usr/local/opt/llvm/bin:/usr/local/bin:/usr/local/opt/coreutils/libexec/gnubin:$PATH"
    export MANPATH="/usr/local/opt/coreutils/libexec/gnuman:$MANPATH"
fi

zplug 'zplug/zplug', hook-build:'zplug --self-manage'
zplug 'MaT1g3R/lambda-mod-zsh-theme', as:theme

zplug "plugins/git", from:oh-my-zsh
zplug "plugins/wd", from:oh-my-zsh
zplug "plugins/python", from:oh-my-zsh
zplug "plugins/stack", from:oh-my-zsh
zplug "plugins/vi-mode", from:oh-my-zsh
zplug "plugins/fancy-ctrl-z", from:oh-my-zsh

zplug "zsh-users/zsh-syntax-highlighting", defer:2

if ! zplug check --verbose; then
    printf "Install? [y/N]: "
    if read -q; then
        echo; zplug install
    fi
fi
zplug load
